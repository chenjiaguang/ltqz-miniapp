<!--pages/orderdetail/orderdetail.wxml-->
<ft-custom-nav title="{{navTitle}}" />
<view class='page-orderdetail'>
  <view class="left-time{{(countdown > 0 && countdown_text) ? ' show' : ''}}"><text>{{countdown_text}}</text></view>
  
  <view class='row goods' bindtap='goGoodsDetail'>
    <image class='goods-cover' src="{{product.cover_url}}" mode="aspectFill"></image>
    <view class='goods-content flex1 column'>
      <text class='goods-title bold'>{{product.title}}</text>
      <text wx:if="{{product.valid_btime && product.valid_etime}}" class='goods-time'>{{product.valid_btime}} 至 {{product.valid_etime}}</text>
      <text class='goods-location'>{{product.address}}</text>
    </view>
    <text class='lutufont lutu-next2'></text>
  </view>

  <view wx:if="{{order.tuan && order.tuan.id}}">
    <view class='block-separator'></view>
    <group-overview group="{{order.tuan}}" catchshare="shareTap" />
  </view>

  <view class='list'>
    <view class='title'>订单信息</view>
    <view class='line-separator-h'></view>
    <view class='item row'>
      <text class='key'>{{order.type == 1 ? '活动名称' : '商品名称'}}</text>
      <text class='value'>{{product.title}}</text>
    </view>
    <view class='line-separator-h'></view>
    <view class='item row'>
      <text class='key'>{{order.type == 1 ? '活动地点' : '地点'}}</text>
      <text class='value'>{{product.address || '--'}}</text>
    </view>
    <block wx:if="{{order.type == 2 && order.hx_rule}}">
      <view class='line-separator-h'></view>
      <view class='item row'>
        <text class='key'>核销有效期</text>
        <text class='value'>{{order.hx_rule || '--'}}</text>
      </view>
    </block>
    <view wx:if="{{order.type == 1}}" class='line-separator-h'></view>
    <view wx:if="{{order.type == 1}}" class='item row'>
      <text class='key'>活动场次</text>
      <text class='value'>{{product.session}}</text>
    </view>
    <view class='line-separator-h'></view>
    <view class='item row'>
      <text class='key'>购买数量</text>
      <text class='value'>{{order.ticket_text}}</text>
    </view>
    <view class='line-separator-h'></view>
    <view class='item row'>
      <text class='key'>实付金额</text>
      <text class='value'>¥{{order.show_price}}{{(product.include_bx == 1) ? '（费用包含保险）' : ''}}</text>
    </view>
    <view class='line-separator-h'></view>
    <view class='item row'>
      <text class='key'>订单编号</text>
      <text class='value'>{{order.order_id}}</text>
    </view>
    <view class='line-separator-h'></view>
    <view class='item row'>
      <text class='key'>下单时间</text>
      <text class='value'>{{order.created_at}}</text>
    </view>
  </view>

  <view class='list' wx:if="{{traveler_infos && traveler_infos.length}}">
    <view class='title'>出行人信息</view>
    <block wx:if="{{product.include_bx == 1}}">
      <block wx:for="{{traveler_infos}}" wx:key="name">
        <view class='line-separator-h'></view>
        <view class='item row'>
          <text class='key'>{{item.productTraveler.name}}</text>
          <text class='value'><text wx:for="{{item.productTraveler.id_number}}" wx:key="*this" wx:for-item="str" wx:for-index="stridx">{{(stridx >= 4 && stridx < item.productTraveler.id_number.length - 4) ? '*' : str}}</text></text>
        </view>
      </block>
    </block>
    <block wx:if="{{product.include_bx != 1 && traveler_name_text}}">
      <view class='line-separator-h'></view>
      <view class='item row'>
        <text class='key'>{{traveler_name_text}}</text>
      </view>
    </block>
  </view>

  <view wx:if="{{contact_info && contact_info.length}}" class='list'>
    <view class='title'>联系人信息</view>
    <view wx:for="{{contact_info}}" wx:key="label">
      <view class='line-separator-h'></view>
      <view class='item row'>
        <span class='key'>{{item.label}}</span>
        <span class='value'>{{item.value}}</span>
      </view>
    </view>
  </view>
  <view wx:if="{{order.status && (order.status === '0' || (order.status !== '0' && order.status !== '-1'))}}" class='bottom-button-wrapper'>
    <view class='bottom-button-height'></view>
    <ft-iphone-bottom-adapter />
    <view class='bottom-button'>
      <view wx:if="{{order.status == 0}}" class="bottom-button-inner-height pay{{repaying ? ' disabled' : ' theme-bg'}}" catchtap="repay">
        <text>立即支付</text>
      </view>
      <view wx:if="{{order.status == 1 || order.status == 2 || order.status == 3 || order.status == 5}}" class='bottom-button-inner-height ticket theme-bg' bindtap='goGoodsTicket'>
        <text>查看电子票</text>
      </view>
      <ft-iphone-bottom-adapter />
    </view>
  </view>
</view>
<draw-poster id="c-draw-poster" />